define(["jquery","knockout","datatables","truncate-utils","resource-bundle","dataTables.buttons","buttons.html5","jszip","buttons.colVis","buttons.print","tablesearch","moment","date-util","underscore","jquery.mark","datatables-responsive"],function(e,t,a,n,s,l,o,i,r,c,d,u,p,h,b){"use strict";function f(e,t,a){var n=e.aoData[t];n._aSortData=null,n._aFilterData=null}function g(e){var t=e._iDisplayStart,a=e._iDisplayLength,n=e.fnRecordsDisplay(),s=-1===a,l=s?0:Math.ceil(t/a),o=s?1:Math.ceil(n/a),i=l>0?"":e.oClasses.sPageButtonDisabled,r=o-1>l?"":e.oClasses.sPageButtonDisabled;return{first:i,previous:i,next:r,last:r}}function m(e){return Math.ceil(e._iDisplayStart/e._iDisplayLength)+1}function v(e){return Math.ceil(e.fnRecordsDisplay()/e._iDisplayLength)}window.JSZip=i;var w=function(a,l,o,i){var r=this;r.vmValuesAccessor=l,r.tableInstance=null,r.dataTableBindingContext=o,r.childColWidths=[],r.dataTableOptions={},r.elem=a,r.viewModel=i,r.truncateUtil=n,r.rowToggleIndex=null,r.currentSelection=t.observable("visible"),r.rowSelectionMessage="<div class='row-select-message' style='display:none;'>\r\n                                        <span></span>\r\n                                        <a href='javascript:void(0);' data-bind='click:$data.selectAllRows'></a>\r\n                                    </div>",r.init=function(){if(r.dataTableOptions=e.extend(!0,{},r.DEFAULT_OPTIONS,r.vmValuesAccessor.options),r.buttonToolsVM=r.viewModel,r.dataTableOptions.columns=r.getColDefinitions(),r.dataTableOptions.paging===!1&&(r.dataTableOptions.info=!1),r.dataTableOptions.serverSide&&"function"==typeof r.dataTableOptions.ajax&&(r.dataTableOptions.serverSide=!0,r.dataTableOptions.processing=!0,r.dataTableOptions.dataSrc="data"),r.inProgress=t.isObservable(r.vmValuesAccessor.inProgress)?r.vmValuesAccessor.inProgress:t.isObservable(r.viewModel.inProgress)?r.viewModel.inProgress:t.observable(!1),r.vmValuesAccessor.options&&(r.vmValuesAccessor.options.emptyTable&&(r.dataTableOptions.language.emptyTable=r.vmValuesAccessor.options.emptyTable),r.vmValuesAccessor.options.viewModel&&(r.buttonToolsVM=r.vmValuesAccessor.options.viewModel)),r.rowProcessing=t.isObservable(r.vmValuesAccessor.rowProcessing)?r.vmValuesAccessor.rowProcessing:t.isObservable(r.viewModel.rowProcessing)?r.viewModel.rowProcessing:t.observable(r.dataTableOptions.language.rowProcessing),"checkbox"===r.dataTableOptions.columns[0].data&&(r.dataTableOptions.buttonTools&&(r.dataTableOptions.buttonTools.selectedAll&&(r.selectedAll=r.dataTableOptions.buttonTools.selectedAll),r.dataTableOptions.buttonTools.selectedRows&&(r.selectedRows=r.dataTableOptions.buttonTools.selectedRows)),void 0===r.selectedAll&&(void 0===r.buttonToolsVM.selectAll&&(r.buttonToolsVM.selectAll=t.observable(!1)),r.selectedAll=r.buttonToolsVM.selectAll),void 0===r.selectedRows&&(void 0===r.buttonToolsVM.selectedRows&&(r.buttonToolsVM.selectedRows=t.observableArray()),r.selectedRows=r.buttonToolsVM.selectedRows)),r.registerTableSelection(),r.tableInstance=e(r.elem).DataTable(r.dataTableOptions),1==r.dataTableOptions.serverSide&&r.tableInstance.fnFilterOnReturn(),r.inProgressSubscription=null,r.dataArraySubscription=null,r.dataTableOptions.serverSide||(r.inProgressSubscription=r.inProgress.subscribe(r.toggleLoadingMessage,r),r.dataArraySubscription=r.vmValuesAccessor.data.subscribe(function(a){null!=a&&(e(this.elem).find("tbody tr [data-bind]").each(function(a,n){e(n).unbind(),t.cleanNode(e(n)[0])}),this.tableInstance.clear(),this.tableInstance.rows.add(a).draw(!1))},r)),r.createActionButtons(),r.selectedAll&&(r.tableInstance.on("page.dt",function(){r.recomputeSelectAll()}),r.tableInstance.on("search.dt",function(){r.recomputeSelectAll()}),r.tableInstance.on("draw.dt",function(){var t=e(r.elem).find("tbody .dataTables_empty");e(r.elem).find('thead input[type="checkbox"]').prop("disabled",0!=t.length),e(r.elem).find(".select-all-option").attr("disabled",0!=t.length)})),r.dataTableOptions.advancedSearch&&new e.fn.DataTable.AdvancedSearch(r.tableInstance,r.dataTableOptions),!r.dataTableOptions.serverSide){var a=t.unwrap(r.vmValuesAccessor.data);a.length>0&&r.tableInstance.rows.add(a).draw(!1)}r.vmValuesAccessor.datatableRef&&r.vmValuesAccessor.datatableRef(r.tableInstance),r.tableInstance.on("search.dt",function(e,t){r.searchChildRows(e,t)}),r.messageID="row-selection-message_"+r.tableInstance.settings()[0].sInstance,e(r.rowSelectionMessage).attr("id",r.messageID).insertBefore(e("#"+e(r.elem).attr("id")))},r.flattenChildRows=function(e){r.buttonToolsVM.expandChildDetails=r.expandChildDetails;var a=h.pluck(r.tableInstance.settings()[0].aoColumns,"data"),n=t.unwrap(e),s="",l="",o="",i="";return n.hasOwnProperty("child")&&n.child&&n.child.length>0?(n.child.forEach(function(e){s=a.map(function(a){return t.isObservable(e[a])?t.unwrap(e[a]):e[a]}),l+=" "+s.join(" "),i="",e.hasOwnProperty("child")&&e.child&&e.child.length>0&&(e.child.forEach(function(e){o=a.map(function(a){return t.isObservable(e[a])?t.unwrap(e[a]):e[a]}),i+=" "+o.join(" ")}),e._allChildren=i)}),n._allChildren=l):n._allChildren=l,n},r.expandChildDetails=function(t,a){a.stopPropagation();var n=e(a.target),s=n.closest("tr").next(),l=!1;e(s).has("table").length>0&&(l=!0),n.hasClass("fa-caret-right")?(n.removeClass("fa-caret-right").addClass("fa-caret-down"),l&&(e(s).removeClass("hidden"),e(s).find("table >tbody>tr").removeClass("hidden"))):(n.removeClass("fa-caret-down").addClass("fa-caret-right"),l?e(s).addClass("hidden"):null)},r.searchChildRows=function(a,n){var s=e(r.elem).attr("id"),l=e("#"+s+"_filter").find("input").val();l=l.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");var o,i=new RegExp(l,"i"),c="",d={},u=!1,p=[],b=h.pluck(r.tableInstance.settings()[0].aoColumns,"data");e.each(r.tableInstance.settings()[0].aiDisplay,function(a,n){var s=r.tableInstance.row(n);if(s.data().child&&s.data().child.length>0){var h=!1;if(s.child.isShown()||null==l||""==l){u=!1;var f,g="",m=[],v=[],w=e(s.child()).find("table:first>tbody>tr");e.each(w,function(t,a){0===e(a).has("table").length&&v.push(a)}),h=!1,e.each(v,function(a,n){u=!1,e(n).has("table")&&null!=s.data().child[a]&&(c=b.map(function(e){return t.isObservable(s.data().child[a][e])?t.unwrap(s.data().child[a][e]):s.data().child[a][e]}),i.test(c.join(" "))?(e(n).removeClass("hidden"),f=e(n).next("tr").find("table>tbody>tr"),e.each(f,function(n,l){g=b.map(function(e){return s.data().child[a].child&&s.data().child[a].child[n]?t.isObservable(s.data().child[a].child[n][e])?t.unwrap(s.data().child[a].child[n][e]):s.data().child[a].child[n][e]:""}),i.test(g.join(" "))?(e(l).removeClass("hidden"),u=!0):e(l).addClass("hidden")}),u&&m.push(n),h=!0):(e(n).addClass("hidden"),e(n).find(".childDetails").trigger("click",[null,"autoexpand"]),f=e(n).next("tr").find("table>tbody>tr"),e.each(f,function(t,a){e(a).addClass("hidden")})))}),m&&m.length>0&&e.each(m,function(t,a){e(a).find(".fa-caret-right").length>0&&e(a).find(".childDetails").trigger("click",["autoexpand",null])}),h&&null!=l&&""!=l||e(s.node()).find("span.details").trigger("click",[null,"autoexpand"])}else{for(var T=s.data().child.length-1;T>=0;T--)if(o=s.data().child[T],null!=s.data().child[T]&&(c=b.map(function(e){return t.isObservable(s.data().child[T][e])?t.unwrap(s.data().child[T][e]):s.data().child[T][e]}),i.test(c.join(" ")))){if(h=!0,o.child&&o.child.length>0)for(var x=o.child.length-1;x>=0;x--)c=b.map(function(e){return t.isObservable(o.child[x][e])?t.unwrap(o.child[x][e]):o.child[x][e]}),i.test(c.join(" "))?u=!0:p.push(x);u&&(d[T]=p);break}if(h){var C=Object.keys(d);e(s.node()).find("span.details").trigger("click",["autoexpand",null]);for(var x=0;x<C.length;x++){e(e(s.node()).next("tr").find(".childDetails")[parseInt(C[x])]).trigger("click",["autoexpand",null]);for(var k=0;k<C[x].length;k++)e(e(s.node()).next("tr").find(".childDetails")[parseInt(C[x])]).closest("tr").next("tr").find("table>tbody>tr").eq(d[C[x]][k]).addClass("hidden")}}}}})},r.getPage=function(){var t=[],a=[];if("all"==r.currentSelection()){var n=r.tableInstance.settings()[0].oSavedState,s=!1;e.each(n.columns,function(e,t){return t.search.search.length>0?(s=!0,!0):void 0}),t=s||n.search.search.length>0||!e.isEmptyObject(n.advSearch)?r.tableInstance.rows(r.tableInstance.settings()[0].aiDisplay).data():r.tableInstance.rows().data()}else r.currentSelection("visible")&&(t=r.tableInstance.rows({page:"current"}).data());return t.each(function(e){a.push(e)}),a},r.getPageNodes=function(){var e,t,a=[];r.tableInstance.columns(0).every(function(a){e=this.data(),t=this.nodes()});for(var n=0;n<e.length;n++)a.push({data:e[n],node:t[n]});return a},r.recomputeSelectAll=function(){for(var e=r.getPage(),t=0;t<e.length&&("function"!=typeof e[t].checkbox||e[t].checkbox());t++);r.selectedAll(t>0&&t==e.length)},r.registerTableSelection=function(){function a(e,t,a){if(e.checkbox(a?a:!e.checkbox()),e.child&&e.child.length)for(var n=0;n<e.child.length;n++){var s=e.child[n];if(s.checkbox(e.checkbox()),s.child)for(var l=0;l<s.child.length;l++){var o=s.child[l];o.checkbox(e.checkbox())}}}function n(e){for(var t=e.child?e.child:[],a=0,s=!1;a<t.length;a++)if("function"==typeof t[a].checkbox&&t[a].checkbox()){s=!0;break}if(e.checkbox(s),e.checkbox()&&void 0===e.parent){var l=r.selectedRows.indexOf(e);0>l&&r.selectedRows.push(e)}e.parent&&n(e.parent)}function s(e,t,a){var s;if(e.checkbox(a?a:!e.checkbox()),e.child)for(s=0;s<e.child.length;s++){var l=e.child[s];l.checkbox(e.checkbox())}if(e.parent){if(e.parent.checkbox(e.checkbox()),e.checkbox()&&e.parent.child){var o=e.parent.child;for(s=0;s<o.length;s++)o[s].member&&o[s].checkbox(e.checkbox())}n(e.parent)}}function l(n,s){var l,o,i=r.dataTableOptions.selectOptions&&r.dataTableOptions.selectOptions.selectionMode||"multi",c=r.dataTableOptions.selectOptions&&r.dataTableOptions.selectOptions.selectionType||"checkbox",d=r.dataTableOptions.selectOptions&&r.dataTableOptions.selectOptions.selectRowsAction||null;if(l=null!=r.vmValuesAccessor.data?r.vmValuesAccessor.data()[n.$index]:r.getPage()[n.$index],o="button"===c||"single"===i?l.checkbox()?!1:!0:s.target.checked,r.dataTableOptions.multiChildRows&&a(l,s),l.checkbox(o),d&&r.buttonToolsVM[d](l),"multi"===i)o?(r.selectedRows.indexOf(l)<0&&r.selectedRows.push(l),r.recomputeSelectAll()):(r.selectedRows.remove(l),r.selectedAll(!1)),("all"===r.currentSelection()||"visible"===r.currentSelection())&&r.selectedRows().length>0?(e("#"+r.messageID+" span").text(r.selectedRows().length+" row(s) have been selected."),t.cleanNode(e("#"+r.messageID+" a")[0]),e("#"+r.messageID+" a").hide(),e("#"+r.messageID).slideDown(300)):e("#"+r.messageID).slideUp(300);else{var u=r.selectedRows()[0];if(u){if(u.checkbox(!1),r.dataTableOptions.multiChildRows&&u.child&&u.child.length)for(var p=0;p<u.child.length;p++){var h=u.child[p];if(h.checkbox(u.checkbox()),h.child)for(var b=0;b<h.child.length;b++){var f=h.child[b];f.checkbox(u.checkbox())}}r.selectedRows.removeAll()}o&&r.selectedRows.push(l)}return!0}function o(a,n){var s=null;s="object"==typeof n&&null!==n?n.target.checked:n;var l=r.selectedRows();"visible"===r.currentSelection()&&(l.forEach(function(e){e.checkbox(!1)}),l=[]);var o=r.getPage();o.forEach(function(e){e.checkbox(s),s&&l.indexOf(e)<0&&l.push(e)});var i=r.getPageNodes();return i.forEach(function(a){var n=e(a.node).find("input");a.node.innerHTML.indexOf("advancedChecked")>-1?t.applyBindingsToNode(n[0],{advancedChecked:a.data}):t.applyBindingsToNode(n[0],{checked:a.data})}),s?r.selectedRows(l):r.selectedRows.removeAll(o),r.selectedAll(s),"all"===r.currentSelection()&&r.selectedRows().length>0||"visible"===r.currentSelection()&&r.selectedRows().length===r.tableInstance.rows().data().length?(e("#"+r.messageID+" span").text("All "+r.selectedRows().length+" rows have been selected."),t.cleanNode(e("#"+r.messageID+" a")[0]),e("#"+r.messageID+" a").hide(),e("#"+r.messageID).slideDown(300)):"visible"===r.currentSelection()&&r.selectedRows().length>0&&r.selectedRows().length!==r.tableInstance.rows().data().length?(e("#"+r.messageID+" span").text("All "+r.selectedRows().length+" visible rows have been selected."),e("#"+r.messageID+" a").text("Select all "+r.tableInstance.rows().data().length+" rows in the table."),t.applyBindingsToNode(e("#"+r.messageID+" a")[0],{click:function(){r.selectAllRows()}}),e("#"+r.messageID+" a").show(),e("#"+r.messageID).slideDown(300)):e("#"+r.messageID).slideUp(300),!0}var i=e(r.elem).find("col")[0];if(i&&"checkbox"===e(i).attr("data")){var c=e(i).attr("template").match(/(?:rowToggleArray[)([0-9]+)(?:])/);c&&(r.rowToggleIndex=parseInt(c[0].match(/\d/)[0]))}r.selectedAll&&(null===r.rowToggleIndex&&(r.buttonToolsVM.selectAllToggle=o,r.buttonToolsVM.rowToggle=l,r.buttonToolsVM.rowToggleChild=s),null!==r.rowToggleIndex&&("undefined"==typeof r.buttonToolsVM.selectAllToggleArray&&(r.buttonToolsVM.selectAllToggleArray=[]),r.buttonToolsVM.selectAllToggleArray[r.rowToggleIndex]||(r.buttonToolsVM.selectAllToggleArray[r.rowToggleIndex]=o),"undefined"==typeof r.buttonToolsVM.rowToggleArray&&(r.buttonToolsVM.rowToggleArray=[]),r.buttonToolsVM.rowToggleArray[r.rowToggleIndex]||(r.buttonToolsVM.rowToggleArray[r.rowToggleIndex]=l)),r.selectedRows.subscribe(function(){0==r.selectedRows().length?(r.selectedAll(!1),e("#"+r.messageID).slideUp(300),r.bulkActionsButtons&&r.bulkActionsButtons.container().is(":visible")&&r.bulkActionsButtons.disable()):r.bulkActionsButtons&&r.bulkActionsButtons.container().is(":visible")&&r.bulkActionsButtons.enable()}))},r.createSettingsActions=function(){var t=r.dataTableOptions.settings,a=[];if(t.colVis){var n=t.colVis.columnVisibility;if(!n){n=[];for(var s=r.dataTableOptions.columns,l=0;l<s.length;l++)"checkbox"===s[l].data||"main-name"===s[l]["class"]||null!=s[l].className&&s[l].className.indexOf("main-name")>-1||n.push(l)}a.push({extend:"collection",className:"btn-link buttons-colvis",iconClass:"fa fa-eye float-left",text:"Column Visibility",domTag:"checkbox",buttons:[{extend:"columnsToggle",columns:n},{action:function(t,a,n,s){e("#"+a.settings()[0].sInstance+"_settingsBtn").trigger("click")},text:"Back",className:"btn-link",iconClass:"fa fa-caret-left float-left"}],action:function(t,a,n,s){var l=n.parent(),o=l.offset();l.fadeOut(s.fade,function(){l.detach()}),e(document).off("click.dtb-collection"),s._collection.addClass(s.collectionLayout).css("display","none").appendTo("body").fadeIn(s.fade),s._collection.css(o),setTimeout(function(){var t=function(a){e(a.target).parents().andSelf().filter(s._collection).length||(s._collection.fadeOut(s.fade,function(){s._collection.detach()}),e(document).off("click",t))};e(document).on("click",t)},10)}})}if(t["export"]){var o=t["export"].exportOptions;t["export"].excel&&a.push({extend:"excelHtml5",className:"btn-link",iconClass:"fa fa-file-excel-o float-left",exportOptions:o}),t["export"].csv&&a.push({extend:"csvHtml5",className:"btn-link",iconClass:"fa fa-file-o float-left",exportOptions:o}),t["export"].print&&a.push({extend:"print",className:"btn-link",iconClass:"fa fa-print float-left",exportOptions:o})}new e.fn.dataTable.Buttons(this.tableInstance,{buttons:[{extend:"collection",text:"",className:"btn-default",iconClass:"fa fa-gear float-left",background:!1,buttons:a}],dom:{container:{className:"float-right"},button:{className:"btn"},collection:{tag:"div",className:"dt-button-collection",button:{tag:"a",className:""}}}})},r.convertOldToNewConfig=function(t){function a(t,a,n){return t?function(){n?r[t].apply(null,a):(e(".dt-button-collection").is(":visible")&&e(".dt-button-collection").hide(),r.buttonToolsVM[t].apply(null,a))}:""}var n,s=[],l=[];for(n=0;n<t.length;n++){var o=void 0!==t[n].params?t[n].params:[],i=t[n].fnClick,c={text:t[n].sButtonText||"",title:t[n].sButtonTitle||"",className:t[n].sButtonClass||"btn-default",iconClass:t[n].sIconClass};if("collection"===t[n].sExtends){l=[];for(var d=t[n].buttons,u=0;u<d.length;u++){var p=d[u].fnClick?d[u].fnClick:null,h=d[u].actionType?d[u].actionType:null,b=void 0!==d[u].params?d[u].params:[];l.push({text:d[u].sButtonText||"",title:d[u].sButtonTitle||"",className:d[u].sButtonClass||"btn-link",iconClass:d[u].sIconClass,action:a(p,b,h)})}c.buttons=l,c.background=!1,c.fade=0,c.extend="collection"}else c.action=a(i,o);s.push(c)}return s},r.createTableActions=function(t){if(0!==t.length){var a=this.convertOldToNewConfig(t);new e.fn.dataTable.Buttons(this.tableInstance,{buttons:a,dom:{container:{className:"float-right"},button:{className:"btn"},buttonLiner:{tag:null,className:""}}})}},r.createBulkActions=function(t){if(0!==t.length){var a=this.convertOldToNewConfig(t);new e.fn.dataTable.Buttons(this.tableInstance,{buttons:a,dom:{container:{className:"float-left"},button:{className:"btn"},buttonLiner:{tag:null,className:""}}})}},r.createQuickFilters=function(a,n,s){var l=null,o=this.tableInstance.settings()[0];o.oLoadedState&&o.oLoadedState.columns[n]&&o.oLoadedState.columns[n].search&&(l=o.oLoadedState.columns[n].search.search);var i=e('<ul class="quick-filter" data-filter-target="'+n+'"></ul>'),c=e("<li></li>");c.html(a.length>1?"Quick Filters: ":"Quick Filter: "),i.append(c);for(var d,u,p,h,b,f,g,m=!1,v=0;v<a.length;v++)f=null!=a[v].filterValue?a[v].filterValue:a[v].filterText,g=null!=a[v].filterTooltip?a[v].filterTooltip:f,u=e('<a href="#" data-bind="click:function(data, event) {self._doQuickFilter(data, event);}"></a>'),t.applyBindingsToNode(u[0],{click:function(e,t){r._doQuickFilter(e,t,s)}}),a[v].filterClass&&(p=e('<span class="'+a[v].filterClass+' tipster" title="'+g+'"></span>'),p.html(" "),u.append(p)),h=e("<span></span>"),h.html(a[v].filterText?(a[v].filterClass?" ":"")+a[v].filterText+" ":" "),u.append(h),a[v].oCount&&(b=e("<b></b>"),t.applyBindingsToNode(b[0],{text:this.buttonToolsVM[a[v].oCount]}),u.append(b)),d=e('<li data-filter="'+f+'"></li>'),null!=l&&l=="^"+f+"$"&&d.addClass("active"),d.append(u),i.append(d);return m&&this.tableInstance.on("search.dt",function(e,t){r.recomputeQFilterCounters(a,n)}),e('<div role="quick-filter"></div>').append(i)},r.recomputeQFilterCounters=function(e,t){var a=r.tableInstance.columns(t,{search:"applied"}).data()[0],n={};a.forEach(function(e){void 0===n[e]?n[e]=1:n[e]++});for(var s,l=e.length-1;l>=0;l--)s=e[l].filterValue||e[l].filterText,r.buttonToolsVM[e[l].oCount](n[s]||0)},r._doQuickFilter=function(t,a,n){a.preventDefault(),a.stopPropagation();var s=e(a.currentTarget.parentElement),l=s.parent().attr("data-filter-target");s.hasClass("active")?(s.removeClass("active"),n&&r.buttonToolsVM[n].apply(null,[""]),r.tableInstance.column(l).search("").draw()):(n&&r.buttonToolsVM[n].apply(null,[s.attr("data-filter")]),r.tableInstance.column(l).search("^"+s.attr("data-filter")+"$",!0).draw(),s.siblings().removeClass("active"),s.addClass("active"))},r.createActionButtons=function(){var t=e('<div class="table-actions"/>'),a=0,n=this.tableInstance.settings()[0].sInstance;if(this.dataTableOptions.settings){this.createSettingsActions(),r.settingsButton=this.tableInstance.buttons(a++,null),r.settingsButton.container().children().attr("id",n+"_settingsBtn");var s=r.settingsButton.container().attr("role","settings");t.append(s)}var l=this.dataTableOptions.buttonTools;if(l&&l.rButtons){this.createTableActions(l.rButtons),r.tableActionsButtons=this.tableInstance.buttons(a++,null);var o=r.tableActionsButtons.container().attr("role","table-actions");t.append(o)}if(this.dataTableOptions.searching&&(e("#"+n+"_filter label").append("<em>Search</em>"),e("#"+n+"_filter input").attr("placeholder","Search"),t.append(e("#"+n+"_filter"))),this.dataTableOptions.ordering&&this.dataTableOptions.hideHeader){e(this.tableInstance.settings()[0].nTHead).hide();var i,c=[{sExtends:"collection",sButtonText:"Sort By",sIconClass:"fa fa-sort right",sButtonClass:"btn-default sortby-btn"}],d=[],u={};this.dataTableOptions.order&&e.each(this.dataTableOptions.order,function(e,t){u[t[0]]=t[1]}),e.each(this.tableInstance.settings()[0].aoColumns,function(e,t){t.bSortable&&(i=t.nTh&&"th.sorting_asc"===t.nTh||"asc"==u[e]?"fa-caret-up":t.nTh&&"th.sorting_desc"===t.nTh||"desc"==u.idx?"fa-caret-down":"fa-sort",d.push({sExtends:"sample-btn",sButtonText:t.title,sIconClass:"fa left "+i,sButtonClass:"btn-link sortby-link",actionType:"sort",fnClick:"sortTable",params:[t]}))}),c[0].buttons=d,this.createTableActions(c),r.tableActionsButtons=this.tableInstance.buttons(a++,null);var p=r.tableActionsButtons.container().attr("role","table-actions");t.append(p)}if(l){if(l.qFilters&&l.qFilters.length>0){var h=this.createQuickFilters(l.qFilters,l.qFilterTarget,l.qFilterFnClick);t.append(h)}if(l.lButtons){this.createBulkActions(l.lButtons),r.bulkActionsButtons=this.tableInstance.buttons(a++,null);var b=r.bulkActionsButtons.container().attr("role","bulk-actions");t.append(b)}}e("#"+this.elem.id+"_wrapper").prepend(t),r.vmValuesAccessor.options&&r.vmValuesAccessor.options.renderActionButtonsCallback&&r.vmValuesAccessor.options.renderActionButtonsCallback()},r.sortTable=function(t){var a=e(event.currentTarget).find("span"),n=e(a).attr("class"),s=t.idx,l="";e(".sortby-link").find("span").removeClass("fa-caret-down fa-caret-up").addClass("fa-sort"),e(a).attr("class",n),a.hasClass("fa-caret-up")?(l="desc",a.removeClass("fa-caret-up").addClass("fa-caret-down")):a.hasClass("fa-caret-down")?(l="asc",a.removeClass("fa-caret-down").addClass("fa-caret-up")):(l="asc",a.removeClass("fa-caret-down fa-sort").addClass("fa-caret-up")),r.tableInstance.column(s).order(l).draw()},r.toggleLoadingMessage=function(a){var n=e(this.elem).find("tbody .dataTables_empty");r.dataTableOptions.serverSide||(a?n.html(this.dataTableOptions.language.loadingRecords):r.vmValuesAccessor.data&&0==r.vmValuesAccessor.data().length?n.html(this.dataTableOptions.language.emptyTable):r.vmValuesAccessor.data&&r.vmValuesAccessor.data().length>0&&n.html(this.dataTableOptions.language.zeroRecords)),n.length>0&&(t.cleanNode(n.parent()[0]),t.applyBindings(r.viewModel,n.parent()[0]))},r.sortHtmlElementsDataTables=function(){e.extend(e.fn.dataTableExt.oSort,{"ip-address-pre":function(e){for(var t=e.split("."),a="",n=0;n<t.length;n++){var s=t[n];a+=1==s.length?"00"+s:2==s.length?"0"+s:s}return a},"ip-address-asc":function(e,t){return t>e?-1:e>t?1:0},"ip-address-desc":function(e,t){return t>e?1:e>t?-1:0}}),e.fn.DataTable.ext.order["dom-text"]=function(t,a){return this.api().column(a,{order:"index"}).nodes().map(function(t,a){return e("input",t).val()})},e.fn.DataTable.ext.order["dom-text-numeric"]=function(t,a){return this.api().column(a,{order:"index"}).nodes().map(function(t,a){return 1*e("input",t).val()})},e.fn.DataTable.ext.order["dom-select"]=function(t,a){return this.api().column(a,{order:"index"}).nodes().map(function(t,a){return e("select",t).val()})},e.fn.DataTable.ext.order["dom-checkbox"]=function(t,a){return this.api().column(a,{order:"index"}).nodes().map(function(t,a){return e("input",t).prop("checked")?"1":"0"})},e.fn.DataTable.ext.order.weighted=function(t,a){return this.api().column(a,{order:"index"}).nodes().map(function(t,a){return e("[weight]",t).attr("weight")})}},r.cleanUp=function(){null!=r.inProgressSubscription&&r.inProgressSubscription.dispose(),null!=r.dataArraySubscription&&r.dataArraySubscription.dispose(),r.tableInstance.off("page.dt"),r.tableInstance.off("search.dt"),r.tableInstance.off("draw.dt");var a=e(r.elem).attr("id");e("#"+a).find("[data-bind]").each(function(a){t.cleanNode(e(this)[0]),e(this).unbind()}),e("#"+a).empty(),r.tableInstance.destroy(!0)},r.initRowCallback=function(a,n,s){var l=e(a).find("[col-data-bind]"),o={},i={position:"absolute","z-index":1e4,left:"20px"};t.utils.extend(o,n),o.__proto__=n.__proto__,t.utils.extend(o,{$data:r.dataTableBindingContext.$data,$index:s}),o.enableRow&&o.enableRow()===!1&&e(a).attr("data-bind","css:!enableRow?'no-class':'loading-row disabled'"),o.inprogress&&t.isObservable(o.inprogress)&&o.inprogress.subscribe(function(t){if(t){var n=e("<div class = 'row-overlay'><span class='spinner-circle'><span class='circle-maker bg-orange-light small'>\r\n                <span class='fa-refresh fa-spin fa txt-white'></span></span><span class='txt-14'>"+r.rowProcessing()+"</span></span></div>"),s=e(a).css("width"),l=e(a).css("height");i.width=s,i.height=l,e(a).addClass("loading-row disabled"),e(n).css(i),e(a).append(n),r.selectedRows().length>0&&r.bulkActionsButtons.disable()}else e(a).removeClass("loading-row disabled"),e(a).find(".row-overlay").remove();r.rowProcessing(r.dataTableOptions.language.rowProcessing)},a);for(var c=0;c<l.length;c++)e(l[c]).attr("data-bind",e(l[c]).attr("col-data-bind"));if(l.length>0&&t.applyBindings(o,a),r.dataTableOptions.childRowTemplate){var d=r.tableInstance.row(a);d.data().child&&(d.child(r.dataTableOptions.childRowTemplate),t.applyBindings(o,d.child()[0]))}},r.initTableCallback=function(a,n){if(a.oFeatures.bPaginate){var s="<div class='nWrapper'><a href='javascript:;' class='fa fa-gear nInfoToggle'></a></div>",l=a.sInstance,o=e("#"+l+"_length");e(s).insertAfter(e("#"+l+"_info")),o.addClass("gear-dropdown").hide(),o.insertAfter(e("#"+l+"_wrapper .nWrapper")),e("#"+l+"_wrapper .nInfoToggle").on("click",function(e){e.stopPropagation(),o.toggle()});var i=function(t){0==e(t.target).closest("#"+l+"_length").length&&"block"===e(o).css("display")&&o.hide()};e(document).off("click",i).on("click",i);var c=o.find("select");c&&t.applyBindingsToNode(c[0],{event:{change:function(){o.hide()}}})}var d={},u=e("#"+l).find("th [col-data-bind]"),p={};if(t.utils.extend(p,d),p.__proto__=d.__proto__,t.utils.extend(p,{$data:r.dataTableBindingContext.$data}),u.length>0){void 0!==u[0]&&(e(u[0]).attr("data-bind",e(u[0]).attr("col-data-bind")),t.applyBindings(p,e(u[0]).parent()[0]));for(var h=1;h<u.length;h++)e(u[h]).hasClass("select-all-option")&&(e(u[h]).attr("data-bind",e(u[h]).attr("col-data-bind")),t.applyBindings(r,e(u[h]).parent()[0]))}e("#"+l).on("click","span.details",function(t,a,n){var s=e(this).closest("tr"),l=e(s[0]).find("td"),o=r.tableInstance.row(s);if(o.child.isShown()&&(null==n||null!=n&&s.hasClass(n)))o.child.hide(),e(this).addClass("fa-caret-right").removeClass("fa-caret-down"),s.removeClass("shown").removeClass("nestedParent"),n&&s.removeClass(n);else if(!o.child.isShown()&&(null!==a||null==a&&null==n)){if(e(this).addClass("fa-caret-down").removeClass("fa-caret-right"),r.vmValuesAccessor.childRowFormat){var i=r.vmValuesAccessor.childRowFormat(o.data());o.child(i).show()}else o.child.show();a&&!s.hasClass("shown")&&s.addClass(a),s.addClass("shown").addClass("nestedParent"),e(".tipster").tooltipster({position:"top",debug:!1,theme:"tooltipster-shadow"}),e.each(e(".nestedTable tr"),function(t,a){for(var n=0;n<l.length;n++){var s=e(l[n]).width();e(".nestedTable tr:eq("+t+") td:eq("+n+")").width(s+"px")}})}r.vmValuesAccessor.options&&r.vmValuesAccessor.options.expandRowCallback&&r.vmValuesAccessor.options.expandRowCallback()}),r.sortHtmlElementsDataTables()},r.drawCallback=function(t){if(r.toggleLoadingMessage(r.inProgress()),e("a.seemore,a.seeless").off().on("click",function(t){var a=e(this).data("showmore")+" ",n=e(this).data("showless")+" ";e(this).hasClass("seemore")?(e(this).removeClass("seemore").addClass("seeless"),e(this).html("less"),e(this).parent().contents()[0].textContent=a):(e(this).removeClass("seeless").addClass("seemore"),e(this).html("more"),e(this).parent().contents()[0].textContent=n)}),e("a.expmore,a.expless").off().on("click",function(t){var a=e(this).data("showmore")+" ",n=e(this).data("showless")+" ";e(this).hasClass("expmore")?(e(this).removeClass("expmore").addClass("expless"),e(this).html("- less"),e(this).parent().contents()[0].textContent=" ",e(this).parent().prepend(a)):(e(this).removeClass("expless").addClass("expmore"),e(this).html("+"+e(this).data("len")+" more"),e(this).parent().find("ul").remove(),e(this).parent().prepend(n))}),e("#"+t.sTableId+" .tipster, #"+t.sTableId+"_wrapper .tipster").tooltipster({position:"top",theme:"tooltipster-shadow",debug:!1}),r.dataTableOptions.expanded&&r.expandAllChildren(),r.vmValuesAccessor.options&&r.vmValuesAccessor.options.drawCallbackFn&&r.vmValuesAccessor.options.drawCallbackFn(),null!==r.tableInstance&&(""!==r.tableInstance.search()&&r.searchChildRows(),r.tableInstance.rows({filter:"applied"}).data().length)){var a=e(r.tableInstance.table().body()),n=r.tableInstance.search();a.unmark(),a.mark(n,{separateWordSearch:!1}),e.each(r.tableInstance.settings()[0].aiDisplay,function(t,a){var s=r.tableInstance.row(a);if(s.data().child&&s.data().child.length>0){var l=e(s.child()).find("table:first>tbody>tr").not("table");l.unmark(),l.mark(n,{separateWordSearch:!1})}})}},r.getTruncatedText=function(a,n,s,l,o,i){var r=t.unwrap(a.vmValuesAccessor.data),c=t.unwrap(n);if("filter"===s||"sort"===s)return c;if(i.truncate){var d=i.truncateoptions?e.parseJSON(i.truncateoptions.value):{},u=i.truncate.value;d&&d.optionsArr&&r&&r.length>0&&(d.optionsArr=t.unwrap(r[o.row][d.optionsArr]));var p=a.truncateUtil.init(c,u,d);if(i.template)if(c&&c.length!==p.replace("...","").length){c=e(i.template.value).attr("title",c).get(0).outerHTML;var h=r&&r.length>0?r[o.row][i.data.value]:"";t.isObservable(h)?h(p):h=p}else c=i.template.value;else c&&c.length!==p.replace("...","").length&&(c=p)}else i.template&&(c=i.template.value);if(l=a.flattenChildRows(l),i.expandable){if(a.childColWidths=i.childcolwidths?i.childcolwidths.value.split(","):[],a.dataTableOptions.multiChildRows&&l.child&&l.child.length>0)return"<a href = 'javascript:;' class='toggle'><span class = 'fa fa-caret-right details' > </span></a> "+c+" <em class='num-child'>("+l.child.length+")</em>";if(void 0!==a.vmValuesAccessor.getChildRows&&a.vmValuesAccessor.getChildRows(l)>0)return a.dataTableOptions.expanded?"<span class='expandedDetail'> "+c+"</span> <em class='num-child'>("+a.vmValuesAccessor.getChildRows(l)+")</em>":"<a href = 'javascript:;' class='toggle'><span class = 'fa fa-caret-right details' > </span></a> "+c+" <em class='num-child'>("+a.vmValuesAccessor.getChildRows(l)+")</em>"}return c},r.selectAllRows=function(){r.currentSelection("all"),null!==r.rowToggleIndex&&Array.isArray(r.buttonToolsVM.selectAllToggleArray)?r.buttonToolsVM.selectAllToggleArray[r.rowToggleIndex](null,!0):r.buttonToolsVM.selectAllToggle(null,!0)},r.selectVisibleRows=function(){r.currentSelection("visible"),null!==r.rowToggleIndex&&Array.isArray(r.buttonToolsVM.selectAllToggleArray)?r.buttonToolsVM.selectAllToggleArray[r.rowToggleIndex](null,!0):r.buttonToolsVM.selectAllToggle(null,!0)},r.getColDefinitions=function(){var a=[],n=r.dataTableOptions.selectOptions;if(n&&"none"!==n.selectionMode){n.selectionMode=n.selectionMode||"multi";var l=n.selectionType||"checkbox",o={targets:0,orderable:!1,data:"checkbox"},i=n.selectAction||"rowToggle";if("multi"===n.selectionMode){var c=n.selectAllFn||"selectAllToggle",d=n.selectAllObservable||"selectAll";"button"===l?(o.width=n.width||"5%",o.title=s.getString(n.title_key||"COMMON_SELECT"),o.template="<!-- ko if: checkbox -->\r\n                            <a class=&quot;btn btn-row-select btn-default active&quot; col-data-bind=&quot;click:$data."+i+"&quot;>\r\n                                Selected<span class=&quot;left fa fa-check-square &quot;></span>\r\n                            </a>\r\n                        <!-- /ko -->\r\n                        <!-- ko ifnot: checkbox -->\r\n                            <a class=&quot;btn btn-row-select btn-default&quot; col-data-bind=&quot;click:$data."+i+"&quot;>\r\n                                Select<span class=&quot;left fa fa-square-o &quot;></span>\r\n                            </a>\r\n                        <!-- /ko -->"):(o.width=n.width||"1%",o.title=r.dataTableOptions.serverSide?"<input type=&quot;checkbox&quot; col-data-bind=&quot;click:$data."+c+",checked:$data."+d+"&quot; >":"<div class=&quot;select-all dropdown&quot;>\r\n                            <input type=&quot;checkbox&quot; col-data-bind=&quot;click:$data."+c+", checked:$data."+d+"&quot;>\r\n                            <button class=&quot;btn btn-default btn-dropdown&quot; type=&quot;button&quot; data-toggle=&quot;dropdown&quot;>\r\n                                <span class=&quot;caret&quot;></span></button>\r\n                                <ul class=&quot;dropdown-menu&quot;>\r\n                                    <li><a href=&quot;javascript:void(0);&quot; class=&quot;select-all-option&quot; col-data-bind=&quot;click:$data.selectAllRows&quot;>Select All Rows</a></li>\r\n                                    <li><a href=&quot;javascript:void(0);&quot; class=&quot;select-all-option&quot; col-data-bind=&quot;click:$data.selectVisibleRows&quot;>Select All Visible Rows</a></li>\r\n                                </ul>\r\n                            </div>",
o.template="<input type=&quot;checkbox&quot; col-data-bind=&quot;checked:"+o.data+",click:$data."+i+"&quot;>")}else"single"===n.selectionMode&&(o.width=n.width||"5%",o.title=s.getString(n.title_key||"COMMON_SELECT"),o.template="<!-- ko if: checkbox -->\r\n                        <a class=&quot;btn btn-row-select btn-default active&quot; col-data-bind=&quot;click:$data."+i+"&quot;>\r\n                            Selected<span class=&quot;left fa fa-circle &quot;></span>\r\n                        </a>\r\n                    <!-- /ko -->\r\n                    <!-- ko ifnot: checkbox -->\r\n                        <a  class=&quot;btn btn-default btn-row-select&quot; col-data-bind=&quot;click:$data."+i+"&quot;>\r\n                            Select<span class=&quot;left fa fa-circle-o &quot;></span>\r\n                        </a>\r\n                    <!-- /ko -->");var u=n.position||0,h=e(r.elem).find("thead").length>0,b="<col targets='"+u+"' orderable=false data='"+o.data+"' width='"+o.width+"' title='"+o.title+"' template='"+o.template+"' >";0===u?(e(e(r.elem).find("colgroup")).prepend(b),h&&e(e(r.elem).find("thead>tr")[0]).prepend("<th rowspan='2'>"+o.title+"</th>")):(e(e(r.elem).find("colgroup")).children().eq(u-1).after(b),h&&e(e(r.elem).find("thead>tr")[0]).children().eq(u-1).after("<th rowspan='2'>"+o.title+"</th>"))}return e(r.elem).find("col").each(function(){var n={},l=this.attributes;if((l.template||l.expandable||l.truncate||l.data)&&(n.render=function(e,t,a,n){return r.getTruncatedText.apply(r,[r,e,t,a,n,l])}),(l.data&&e.inArray(l.data.value,["actions","checkbox"])>-1||(l.title&&l.title.value.length)<1)&&(n.searchable=!1,"checkbox"===l.data.value&&!r.dataTableOptions.serverSide)){var o=this.attributes.title.value;-1!==o.indexOf("input")&&o.indexOf("select-all-option")<0&&(o="<div class='select-all dropdown'>"+this.attributes.title.value+"<button class='btn btn-default btn-dropdown' type='button' data-toggle='dropdown'>\r\n                                <span class='caret'></span></button>\r\n                                <ul class='dropdown-menu'>\r\n                                    <li><a href='javascript:void(0);' class='select-all-option' col-data-bind='click:$data.selectAllRows'>Select All Rows</a></li>\r\n                                    <li><a href='javascript:void(0);' class='select-all-option' col-data-bind='click:$data.selectVisibleRows'>Select All Visible Rows</a></li>\r\n                                </ul>\r\n                            </div>",this.attributes.title.value=o)}if(l.type&&"htmlicons"===l.type.value){n.displayOptions=[];var i=l.displayOptions?l.displayOptions.value:[];i&&r.viewModel[i]?n.displayOptions=t.isObservable(r.viewModel[i])?t.unwrap(r.viewModel[i]):r.viewModel[i]:i&&i.length>0&&(n.displayOptions=i.split(","))}e.each(this.attributes,function(t,a){if("targets"===a.name)n[a.name]=parseInt(a.value);else if("class"===a.name)n.className=a.value;else if("title_key"===a.name)n.title=s.getString(a.value)||"";else if("orderdatatype"===a.name){if(n.orderDataType=a.value,"moment"===a.value){var o=p.getUserDateFormat()+" "+p.getUserTimeFormat(),i=l.datetimeformat?l.datetimeformat.value:o;e.fn.dataTable.moment(i)}}else"orderable"===a.name||"visible"===a.name||"searchable"===a.name?n[a.name]=e.parseJSON(a.value):"truncate"!==a.name||l.template?"dynamictruncate"===a.name?n.createdCell=function(t,a,n,s,l){"string"==typeof a&&(e(t).attr("title",a),e(t).addClass("truncate-text"))}:n[a.name]=a.value:n.createdCell=function(t,a,n,s,o){var i=r.truncateUtil.init(a,l.truncate.value);"string"==typeof a&&a.length!==i.replace("...","").length&&e(t).attr("title",a)}}),"responsivepriority"in n&&(n.responsivePriority=Number(n.responsivepriority)),a.push(n)}),a.push({data:"_allChildren",orderable:!1,searchable:!0,visible:!1,type:"string","class":"main-name",title:"All Children",targets:a.length}),a},r.expandAllChildren=function(){var t=e(r.elem).attr("id");e.each(e("#"+t+" tbody tr span.details"),function(t,a){var n=e(a).parents("tr"),s=(e(n[0]).find("td"),r.tableInstance.row(n));if(e(this).removeClass("fa-caret-right").addClass("fa-caret-down"),r.vmValuesAccessor.childRowFormat){var l=r.vmValuesAccessor.childRowFormat(s.data());s.child(l).show()}else s.child.show();n.addClass("shown").addClass("nestedParent")}),e(".tipster").tooltipster({position:"top",debug:!1,theme:"tooltipster-shadow"}),e.each(e("#"+t+" .nestedTable tr"),function(t,a){for(var n=0;n<arr.length;n++){var s=e(arr[n]).width();e(".nestedTable tr:eq("+t+") td:eq("+n+")").width(s+"px")}})};var c=function(t,a,n){var s=e(e(a).find("td")[t]);if(s.hasClass("list-moreless")&&s.find("a[data-showmore]").length>0){for(var l=s.find("a[data-showmore]")[0].getAttribute("data-showmore").split("</li>"),o=0;o<l.length;o++)l[o]=l[o].replace(/<.*?>/g,"");return l.join(",")}if(s.children().hasClass("seemore"))return s.children().attr("data-showmore");if(s.find("input").length>0)return s.find("input")[0].value;var i=s.text().replace(/\s\s+/g," ");return i};r.DEFAULT_OPTIONS={dom:'rt<"table-footer"ilpf>',searching:!0,ordering:!0,paging:!0,pagingType:"input",advancedSearch:!0,hideHeader:!1,info:!0,stateSave:!0,settings:{colVis:!0,"export":{csv:!0,excel:!0,print:!0,exportOptions:{modifier:{search:"applied"},columns:".sorting, .sorting_asc, .sorting_desc",fnCellExport:c}}},language:{search:"",rowProcessing:"Processing request...",processing:"<span class='spinner-circle'><span class='circle-maker bg-orange-light small'>\r\n                <span class='fa-refresh fa-spin fa txt-white'></span></span><span class='txt-14'> Retrieving data from server...</span></span>",emptyTable:"No data available in table",loadingRecords:"<span class='spinner-circle'><span class='circle-maker bg-orange-light small'>\r\n                <span class='fa-refresh fa-spin fa txt-white'></span></span><span class='txt-14'> Retrieving data from server...</span></span>",info:"Displaying <b>_START_</b> - <b>_END_</b> (of <b>_TOTAL_</b>)",lengthMenu:"Show _MENU_ per page",zeroRecords:"No matching records found"},createdRow:r.initRowCallback,initComplete:r.initTableCallback,drawCallback:r.drawCallback,headerCallback:r.headerCallback}};e.fn.dataTable.Api.register("rows().invalidateCache()",function(e){return this.iterator("row",function(t,a){f(t,a,e)})}),e.fn.dataTable.Api.register("buttons.exportData()",function(e){return this.context.length?C(this.context[0],new a.Api(this.context[0]),e):void 0}),e.fn.dataTable.Api.register("fnFilterOnReturn()",function(e){return this.context.length?T(this.context[0],new a.Api(this.context[0])):void 0});var T=function(t,a){var n=e("input",t.aanFeatures.f);return n.unbind("keyup search input").bind("keypress",function(e){13==e.which&&(a.search(n.val()),a.ajax.reload())}),this};e.fn.dataTable.moment=function(t,a){var n=e.fn.dataTable.ext.type;n.detect.unshift(function(e){return u(e,t,a).isValid()?"moment-"+t:null}),n.order["moment-"+t+"-pre"]=function(e){return""===e||null===e?-(1/0):parseInt(u(e.replace?e.replace(/<.*?>/g,""):e,t,a).format("x"),10)},n.order["moment-"+t+"-asc"]=function(e,t){return t>e?-1:e>t?1:0},n.order["moment-"+t+"-desc"]=function(e,t){return t>e?1:e>t?-1:0}};var x=e("<textarea/>")[0],C=function(t,a,n){var s=e.extend(!0,{},{rows:null,columns:"",modifier:{search:"applied",order:"applied"},orthogonal:"display",stripHtml:!0,stripNewlines:!0,decodeEntities:!0,trim:!0},n),l=function(t){return"string"!=typeof t?t:(s.stripHtml&&(t=t.replace(/<.*?>/g,"")),s.trim&&(t=t.replace(/^\s+|\s+$/g,"")),s.stripNewlines&&(t=t.replace(/\n/g," ")),s.decodeEntities&&(x.innerHTML=t,t=e(x).html()),t)},o=a.columns(s.columns).indexes().filter(function(e){return a.columns(e).visible()[0]}).sort().map(function(e,t){return l(a.column(e).header().innerHTML)}).toArray(),i=a.table().footer()?a.columns(s.columns).indexes().filter(function(e){return a.columns(e).visible()[0]}).sort().map(function(e,t){return l(a.column(e).footer().innerHTML)}).toArray():null,r=a.rows(s.rows,s.modifier).indexes().map(function(e,n){return a.columns(s.columns).indexes().filter(function(e){return a.columns(e).visible()[0]}).sort().map(function(n){if(s.fnCellExport){for(var o=t.aoData[e].nTr,i=-1,r=0;n>=r;r++)t.aoColumns[r].bVisible&&i++;return l(s.fnCellExport(i,o,e))}return l(a.cell({row:e,column:n}).render(s.orthogonal))}).toArray()}).toArray();return{header:o,footer:i,body:r}},k=e.fn.dataTable.Buttons.prototype._buildButton;e.fn.dataTable.Buttons.prototype._buildButton=function(e,t){var a=k.call(this,e,t);return a&&(e.iconClass&&a.node.append('<span class="'+e.iconClass+'"></span'),e.title&&a.node.attr("title",e.title).addClass("tipster"),a.node.is("a")&&a.node.attr("href","javascript:void(0)")),a};var A="previous",y="next",O="paginate",I="paginate_of",_="paginate_input";e.fn.dataTableExt.oPagination.input={fnInit:function(t,a,n){var s=document.createElement("a"),l=document.createElement("a"),o=document.createElement("input"),i=document.createElement("span"),r=document.createElement("div"),c=document.createElement("div"),d=(t.oLanguage.oPaginate,t.oClasses,e(a));r.className="paginate_input_con",c.className="paginate_button_con",s.className=A,s.setAttribute("id","sql_table_previous"),s.setAttribute("aria-label","Previous"),s.setAttribute("title","Previous"),s.setAttribute("href","javascript:;"),l.className=y,l.setAttribute("id","sql_table_next"),l.setAttribute("aria-label","Next"),l.setAttribute("title","Next"),l.setAttribute("href","javascript:;"),i.className=I,o.className=_,o.setAttribute("aria-label","Current Page/Go To"),o.type="text",""!==t.sTableId&&(a.setAttribute("id",t.sTableId+"_"+O),s.setAttribute("id",t.sTableId+"_"+A),l.setAttribute("id",t.sTableId+"_"+y)),r.appendChild(o),r.appendChild(i),c.appendChild(s),c.appendChild(l),a.appendChild(r),a.appendChild(c),d.removeClass("dataTables_paginate"),e(s).click(function(){var e=m(t);1!==e&&(t.oApi._fnPageChange(t,"previous"),n(t))}),e(l).click(function(){var e=m(t);e!==v(t)&&(t.oApi._fnPageChange(t,"next"),n(t))}),e(o).keyup(function(a){if(this.value.length>=4){var s=e(a.target);"30px"===s.css("width")&&s.css("width","40px")}if(""!==this.value&&!this.value.match(/[^0-9]/)){var l=t._iDisplayLength*(this.value-1);0>l||l>=t.fnRecordsDisplay()||13===a.which&&(t._iDisplayStart=l,n(t))}}),e(o).focus(function(t){e(t.target).val("")}),e("span",a).bind("mousedown",function(){return!1}),e("span",a).bind("selectstart",function(){return!1});var u=v(t);1>=u&&e(a).hide()},fnUpdate:function(t){if(t.aanFeatures.p){var a=v(t),n=m(t),s=t.aanFeatures.p;if(1>=a)return void e(s).hide();var l=g(t);e(s).show(),e(s).find("."+A).removeClass(t.oClasses.sPageButtonDisabled).addClass(l[A]),e(s).find("."+y).removeClass(t.oClasses.sPageButtonDisabled).addClass(l[y]),e(s).find("."+I).html(" / "+a),e(s).find("."+_).val(n)}}},t.bindingHandlers.dataTable=function(){return{init:function(e,a,n,s,l){var o=new w(e,t.unwrap(a()),l,s);return o.init(),t.utils.domNodeDisposal.addDisposeCallback(e,function(){o.cleanUp()}),{controlsDescendantBindings:!0}}}}()});