define(["jquery","knockout","dialog-utils","datatables-knockout","acs-resource","alert-utils","resource-bundle","underscore"],function(e,n,u,r,t,s,o,c){function i(){var n=this,u={nextId:1,column1:[],column2:[],column3:[],cache:{},reset:function(){this.column1=[],this.column2=[],this.column3=[]}};n.getCreateMenuList=function(e,n){var u=c.filter(e,function(e){return e.menuText===n})[0];return u?u.submenus:[]},n.constructMenuLayout=function(n){var m="";return r(n),e.each(n,function(e,n){var f=5,h="";if(0!==n.submenus.length||"#"!==n.url)if(i(n)){var p=c.groupBy(n.submenus,"sectionMenu")[!0],d=c.groupBy(n.submenus,"sectionMenu")[!1];if(d&&d.length>0){var b={url:"",menuText:"Other",submenus:[],favoriteMenu:!0,isLeaf:!1,level:2,sectionMenu:!0,icon:"fa-sitemap"};Array.prototype.push.apply(b.submenus,d),p.push(b)}u.reset(),p.forEach(function(e){r(e.submenus);var n=e.submenus.length+1;s(u.column1)+n<=f?u.column1.push(e):s(u.column2)+n<=f?u.column2.push(e):s(u.column3)+n<=f?u.column3.push(e):(f+=1+e.submenus.length,u.column1.push(e))});var v=0;u.column3.length>0?v=3:u.column2.length>0?v=2:u.column1.length>0&&(v=1),h=l(v),m+=o(n,h,u.column1.length>0?!0:!1),u.column1.length>0&&(m+=t(u.column1)),u.column2.length>0&&(m+=t(u.column2)),u.column3.length>0&&(m+=t(u.column3)),m+="</li>"}else{r(n.submenus);var M,g=a(n,0),v=Math.ceil(g/f);M=0===v?g:Math.ceil(g/v),h=l(v),m+=o(n,h,g>0?!0:!1);for(var x=0,T=0;v>=T;T++){m+='<div class="col-menu">';for(var y=0,G=x;G<n.submenus.length&&!(y>=M);G++)m+='<a href="'+n.submenus[G].url+'">'+n.submenus[G].menuText+"</a>",x++,y++;m+="</div>"}m+="</div>",m+="</li>"}}),m},n.perfBenchmark=function(e,n,u){};var r=function(e){e&&e.constructor===Array&&e.sort(function(e,n){return e.order=e.order||-1,n.order=n.order||-1,e.order-n.order||e.menuText.localeCompare(n.menuText)})},t=function(e){var n="";if(e.length>0){n+='<div class="col-menu">';for(var u=0;u<e.length;u++)if(e[u].isLeaf)n+='<a href="'+e[u].url+'">'+e[u].menuText+"</a>";else{n+='<h4 class="menu-title">'+e[u].menuText+"</h4>";for(var r=0;r<e[u].submenus.length;r++)n+='<a href="'+e[u].submenus[r].url+'">'+e[u].submenus[r].menuText+"</a>"}n+="</div>"}return n},s=function(e){return e.reduce(function(e,n){return e+(n.submenus.length+1||0)},0)},o=function(e,n,u){return u?'<li class="dropdown"><a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">'+e.menuText+'<span class="icon-chevron"></span></a><div class="dropdown-menu '+n+'" role="menu">':'<li class="dropdown"><a href="'+e.url+'">'+e.menuText+"</a>"},i=function(e){var n=!1;return e.submenus.forEach(function(e){return e.sectionMenu?n=e.sectionMenu:void 0}),n},a=function(e,n){return e.submenus.forEach(function(e){e.submenus.length>0?n=1+a(e,n):n++}),n},l=function(e){var n;switch(e){case 2:n="col-menu-2";break;case 3:n="col-menu-3";break;default:n="col-menu-1"}return n};n.insertMenuItem=function(e,u){if(u.menu.indexOf("|")<0){var r=m(e,u.menu);r?(e.splice(e.indexOf(r),1),e.push({url:u.path,menuText:u.menu,submenus:r.submenus,icon:u.icon||"fa-sitemap",favoriteMenu:u.favoriteMenu,subMenuGroup:u.subMenuGroup,order:u.order,sectionMenu:!1})):e.push({url:u.path,menuText:u.menu,submenus:[],icon:u.icon||"fa-sitemap",favoriteMenu:u.favoriteMenu,subMenuGroup:u.subMenuGroup,order:u.order,sectionMenu:!1})}else{var t=u.menu.split("|"),s=t[0].trim(),o=m(e,s);if(o||(o={url:u.path,sectionMenu:!1,menuText:s,submenus:[],icon:u.icon||"fa-sitemap",subMenuGroup:u.subMenuGroup},e.push(o)),t.length>2){var c=t[1].trim(),i=m(o.submenus,c);i||(i={url:"",menuText:c,submenus:[],favoriteMenu:!0,sectionMenu:!0,icon:u.icon||"fa-sitemap",subMenuGroup:u.subMenuGroup},o.submenus.push(i))}u.menu=u.menu.substring(u.menu.indexOf("|")+1).trim(),n.insertMenuItem(o.submenus,u)}};var m=function(n,u){var r=null;return e.each(n,function(e,n){return n.menuText===u?r=n:void 0}),r}}return new i});