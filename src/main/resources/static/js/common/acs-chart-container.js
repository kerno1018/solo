define(["jquery","knockout","signal-emitter","datatables","datatables-knockout","acs-resource","httputils","dialog-utils","alert-utils","text!./templates/configure-chart-modal-body.tmpl.html","text!./templates/select-chart-modal-body.tmpl.html","text!./templates/edit-finding-modal-body.tmpl.html","ojs/ojcore","ojs/ojknockout","ojs/ojchart"],function($,ko,signalEmitter,datatables,datatablesKnockout,RestResource,httpUtil,dialogUtils,alertUtils,configureChartModal,selectChartModal,editFindingModal){function SelectChartViewModel(e,n,a,t){var i=this,r="chartbuilder/charts";i.type=e,i.chartList=ko.observableArray(),i.chartDef=ko.observable(),i.params=ko.observableArray(),i.chartName=ko.computed(function(){return i.chartDef()?i.chartDef().name:""}),i.reportParams=ko.observableArray(),i.chartTableOptions={order:[[1,"asc"]],emptyTable:"Loading...",pageLength:5,lengthMenu:[5,10,25,50,100],settings:!1},i.chartsResource=new RestResource({url:r,global:!1}),i.beforeRoutingAction=function(){i.chartsResource.get().done(function(e){var n=[];$.each(e,function(e,a){if(a.categories){var t=[];$.each(a.categories.split(","),function(e,n){-1==t.indexOf(n)&&t.push(n)}),a.categories=t.join(",")}a.radioButton="",a.selectButton="",n.push(a)}),i.chartList(n)})},i.showConfigureChartModal=function(){n()&&"__NO_CHART_SET__"!=n().name&&i.chartDef(n()),n()&&n().params&&i.params(n().params),i.reportParams(l(a)),$("#configure-chart-modal",t.element).modal("show")},i.closeSelectChartDialog=function(){$("#select-chart-modal",t.element).modal("hide")},i.openSelectChartDialog=function(){(!i.chartList()||i.chartList().length<1)&&i.beforeRoutingAction(),$("#select-chart-modal",t.element).modal("show")},i.saveConfiguration=function(){i.chartDef().params=i.params(),n(i.chartDef()),$("#configure-chart-modal",t.element).modal("hide")},i.saveConfigureDisabled=ko.computed(function(){var e=!0;return $.each(i.params(),function(n,a){"undefined"==typeof ko.unwrap(a.value)&&(e=!1)}),!e||!i.chartDef()},i),i.selectChart=function(e){i.chartDef(i.chartList()[e]),s(i.chartDef()),i.closeSelectChartDialog()},i.addNewBindParam=function(){i.params.push({name:ko.observable(),value:ko.observable()})},i.setParamValue=function(e,n){e.value(n)},i.removeParam=function(e){i.params.splice(e,1)};var o=function(e){return $.ajax({url:"rest/namedSql/"+e,dataType:"json"})},s=function(e){var n=[];if(!e)return n;if("NAMED_SQL"==e.dataSource)o(e.dsNamedSqlID).then(function(e){$.each(e.paramList,function(e,a){n.push({name:ko.observable(a.name),value:ko.observable()})}),i.params(n)});else if("REST"==e.dataSource&&e.dsUrl){var a=e.dsUrl.match(/\{(.*?)\}/g);a&&$.each(a,function(e,a){n.push({name:ko.observable(a.substring(1,a.length-1)),value:ko.observable()})}),i.params(n)}else i.params(n)},l=function(e){var n=e.$report,a=[];for(var t in n)n.hasOwnProperty(t)&&a.push("$report."+t);return a};i.chartTypeArray=[{status:"area",title:"Area",container:"status left tipster",statusIcon:"fa fa-area-chart fa-2x icon",badgeIcon:"",showLabel:!0},{status:"bar",title:"Bar",container:"status left tipster",statusIcon:"fa fa-bar-chart fa-2x icon",badgeIcon:"",showLabel:!0},{status:"line",title:"Line",container:"status left tipster",statusIcon:"fa fa-line-chart fa-2x icon",badgeIcon:"",showLabel:!0},{status:"pie",title:"Pie",container:"status left tipster",statusIcon:"fa fa-pie-chart fa-2x icon",badgeIcon:"",showLabel:!0},{status:"table",title:"Table",container:"status left tipster",statusIcon:"fa fa-table fa-2x icon",badgeIcon:"",showLabel:!0}]}define("text!configure-chart-modal-body.tmpl.html",function(){return configureChartModal}),define("text!select-chart-modal-body.tmpl.html",function(){return selectChartModal}),define("text!edit-finding-modal-body.tmpl.html",function(){return editFindingModal});var randomId=function(){return Math.floor(1e8*Math.random())},createViewModelFunc=function(params,componentInfo){var $data=ko.dataFor(componentInfo.element),reportInstanceId=$data.$report_instance_id,id=componentInfo.element.id?componentInfo.element.id:$(componentInfo.element).attr("id"),type=params.type&&"table"==params.type.toLowerCase()?"Table":"Chart",chartName=ko.observable(params.chart_name),chartObj=ko.observable({name:params.chart_name,params:[]}),chartDialogVM=new SelectChartViewModel(type,chartObj,$data,componentInfo),bindVariable=ko.observable(params.bind_variable),selectedInstanceIdx=ko.observableArray(params.selected_instance_idx||[]),instanceList=params.instance_list||ko.unwrap($data.$report.instance_list),instanceIdProperty=params.instance_id_property||"id",instanceLabelProperty=params.instance_label_property||"name",instancePropertyInBindVariable=params.instance_property_in_bindvariable||"instance_id",snapRangeFrom=ko.isObservable(params.snap_range_from)?params.snap_range_from:ko.observable(params.snap_range_from),snapRangeTo=ko.isObservable(params.snap_range_to)?params.snap_range_to:ko.observable(params.snap_range_to),renderer=ko.isObservable(params.renderer)?params.renderer:ko.observable(params.renderer||"chart"),title=ko.isObservable(params.title)?params.title:ko.observable(params.title),chartTitle=ko.observable(),description=ko.isObservable(params.description)?params.description:ko.observable(params.description),chartDescription=ko.observable(),titleChangeSynced=!0,findings=ko.observableArray(),visible=ko.observable(params.visible===!1?!1:!0),numOfColumn=ko.observable(params.num_of_column||1),showCustomization=ko.isObservable(params.show_customization)?params.show_customization:ko.observable(params.show_customization),toggleButtonLabel=ko.observable("chart"==renderer()?"Table View":"Chart View"),selectedChartInstances=ko.observableArray(),currentInstanceName=ko.observable(),availableInstances=[],showZoomAndScroll=ko.computed(function(){return showCustomization()?"live":"off"}),chartSizeStyle=ko.pureComputed(function(){var e=numOfColumn();return 1==e?"col-md-12":2==e?"col-md-6":"col-md-3"}),re=new RegExp('"?bind_variable"?\\s*?\\:((.|\n)*?})(\\,?)'),paramsStr=$(componentInfo.element).attr("params"),matched=paramsStr.match(re);if(matched){var str=matched[1];str=str.replace(/(\$report\.(.*))(\W)/,function(e,n,a,t){return'"'+n+'"'+(t?t:"")});var obj=eval("("+str+")");for(var k in obj)chartObj().params.push({name:k,value:obj[k]})}$.each(instanceList,function(e,n){var a=ko.unwrap(n[instanceIdProperty]),t=ko.unwrap(n[instanceLabelProperty]);availableInstances.push({index:e,id:a,name:t})});var currentInstance;if($.each(availableInstances,function(e,n){var a=ko.unwrap(bindVariable);return ko.unwrap(a[instancePropertyInBindVariable])==n.id?(currentInstance=n,!1):void 0}),currentInstance=currentInstance||availableInstances[0],selectedInstanceIdx().length<1&&currentInstance)selectedChartInstances.push({instance_id:currentInstance.id,instance_name:currentInstance.name,bindVar:bindVariable}),selectedInstanceIdx.push(availableInstances.indexOf(currentInstance));else{var selected=[];$.each(selectedInstanceIdx(),function(e,n){var a=availableInstances[n],t=$.extend(!0,{},ko.unwrap(bindVariable()));t[instancePropertyInBindVariable]=a.id,selected.push({instance_id:a.id,instance_name:a.name,bindVar:t})}),selectedChartInstances(selected)}chartObj.subscribe(function(e){if(e&&e.name&&chartName()!=e.name){var n={},a={};if($.each(e.params,function(e,t){var i=t.value();n[t.name()]=i&&i.startsWith("$report.")?$data.$report[i.substring(8,i.length)]:i,a[t.name()]=i}),bindVariable(n),chartName(e.name),chartTitle(httpUtil.htmlDecode(e.description)),chartDescription(httpUtil.htmlDecode(e.explanation)),titleChangeSynced=!1,title(chartTitle()),description(chartDescription()),titleChangeSynced=!0,selectedInstanceIdx().length<1){var t;$.each(availableInstances,function(e,n){var a=ko.unwrap(bindVariable);return ko.unwrap(a[instancePropertyInBindVariable])==n.id?(t=n,!1):void 0}),selectedInstanceIdx.push(t?t.index:0)}signalEmitter.dispatch("Report-Component-Param-Changed",[componentInfo.element,"chart_name",e.name]),signalEmitter.dispatch("Report-Component-Param-Changed",[componentInfo.element,"bind_variable",a])}});var onOjViewportChange=function(e,n){snapRangeFrom(n.xMin),snapRangeTo(n.xMax),signalEmitter.dispatch("Report-Component-Param-Changed",[componentInfo.element,"snap_range_from",n.xMin]),signalEmitter.dispatch("Report-Component-Param-Changed",[componentInfo.element,"snap_range_to",n.xMax])},toggleChartSize=function(e){e?numOfColumn(e):(e=numOfColumn(),e=1==e?2:2==e?4:1,numOfColumn(e))};signalEmitter.addListener("Report-Chart-Size-Changed",function(e){toggleChartSize(e)},this),title.subscribe(function(e){titleChangeSynced&&signalEmitter.dispatch("Report-Component-Param-Changed",[componentInfo.element,"title",e])}),description.subscribe(function(e){titleChangeSynced&&signalEmitter.dispatch("Report-Component-Param-Changed",[componentInfo.element,"description",e])}),chartTitle.subscribe(function(e){titleChangeSynced=!1,title()||title(e),titleChangeSynced=!0}),chartDescription.subscribe(function(e){titleChangeSynced=!1,description()||description(e),titleChangeSynced=!0});var toggleTable=function(e,n){"table"===renderer()?(renderer("chart"),toggleButtonLabel("Chart View")):(renderer("table"),toggleButtonLabel("Table View")),signalEmitter.dispatch("Report-Component-Param-Changed",[componentInfo.element,"renderer",renderer()])},openChartBuilder=function(e){window.open("#/developer/chart_builder/editor/"+chartName()+"?instance_qualifier="+reportInstanceId+"&secondary_qualifier="+id,"Chart Editor","width=1024,height=800,scrollbars=yes")};selectedInstanceIdx.subscribe(function(e){selectedChartInstances.removeAll(),e.length>0&&$.each(e,function(e,n){var a=availableInstances[n],t=$.extend(!0,{},bindVariable());t[instancePropertyInBindVariable]=a.id,selectedChartInstances.push({instance_id:a.id,instance_name:a.name,bindVar:t})})});var toggleSelectAllInstances=function(){if(selectedInstanceIdx().length==availableInstances.length)selectedInstanceIdx([]);else{var e=[];$.each(availableInstances,function(n,a){e.push(a.index)}),selectedInstanceIdx(e)}return!0};signalEmitter.addListener("Report-Instance-Selection-Changed",function(e){selectedInstanceIdx(e)},this),signalEmitter.addListener("Report-Freeze-Display-Control",function(e){signalEmitter.dispatch("Report-Component-Param-Changed",[componentInfo.element,"selected_instance_idx",selectedInstanceIdx()]),signalEmitter.dispatch("Report-Component-Param-Changed",[componentInfo.element,"num_of_column",numOfColumn()]),alertUtils.showSuccessAlert("Display settings are saved")},this),signalEmitter.addListener("Report-Template-Attr-Changed:"+componentInfo.element.id,function(e,n,a){"visible"===n&&visible(a)},this);var afterRender=function(){$("#"+id+" .dropdown-menu").on("click",function(e){e.stopPropagation()})},findingInEditing=null,findingTextInputted=ko.observable(),findingInstanceSelected=ko.observable(),loadFindings=function(){$.ajax({url:"/rest/findings/properties",type:"GET",dataType:"json",data:{k1:"report_instance_id",v1:reportInstanceId,k2:"chart_name",v2:chartName}}).done(function(e){e&&e.length>0?($.each(e,function(e,n){n.text=httpUtil.htmlDecode(n.text)}),findings(e)):findings.removeAll()})},saveEditFinding=function(){findingInEditing.text=findingTextInputted(),findingInEditing.props.chart_name=ko.unwrap(chartName),findingInEditing.props.report_instance_id=reportInstanceId,findingInstanceSelected()?(findingInEditing.props.target_id=findingInstanceSelected().id,findingInEditing.props.target_name=findingInstanceSelected().name):(delete findingInEditing.props.target_id,delete findingInEditing.props.target_name),$.ajax({url:"/rest/findings"+(findingInEditing.id>-1?"/"+findingInEditing.id:""),type:findingInEditing.id>-1?"PUT":"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(findingInEditing)}).done(function(e){loadFindings()}),$("#edit-finding-modal",componentInfo.element).modal("hide")},showEditFindingModal=function(e){if(e){findingInEditing=e,findingTextInputted(e.text);var n=e.props.target_id;findingInstanceSelected(n?availableInstances.find(function(e){return e.id==n}):null)}else findingInEditing={props:{}},findingTextInputted(null),findingInstanceSelected(null);$("#edit-finding-modal",componentInfo.element).modal("show")},removeFinding=function(e){dialogUtils.confirmationDialog("Are you sure to delete this finding?",function(){$.ajax({url:"/rest/findings/"+e.id,type:"DELETE",dataType:"json"}).done(function(e){loadFindings()})})},isValidInput=ko.computed(function(){var e={text:findingTextInputted};return ko.validation.reEvaluate(e,!0)});return loadFindings(),{id:id,type:type,chartName:chartName,title:title,chartTitle:chartTitle,description:description,chartDescription:chartDescription,findings:findings,instanceQualifier:params.instance_qualifier||reportInstanceId,secondaryQualifier:params.secondary_qualifier||id,visible:visible,renderer:renderer,bindVariable:bindVariable,height:params.height,width:params.width,showCustomization:showCustomization,showSnapRange:params.show_snap_range,snapRangeFrom:params.snap_range_from,snapRangeTo:params.snap_range_to,showZoomAndScroll:showZoomAndScroll,showChartBuilderButton:params.show_chart_builder_button,showSaveSnapRangeButton:params.show_save_snap_range_button,showZoomButton:params.show_zoom_button,showToggleTableButton:ko.unwrap(params.allow_toggle)===!1?!1:"Table"===type?!1:!0,onOjViewportChange:onOjViewportChange,openChartBuilder:openChartBuilder,toggleTable:toggleTable,toggleButtonLabel:toggleButtonLabel,chartDialogVM:chartDialogVM,selectedChartInstances:selectedChartInstances,currentInstanceName:currentInstanceName,availableInstances:availableInstances,selectedInstanceIdx:selectedInstanceIdx,instancePropertyInBindVariable:instancePropertyInBindVariable,toggleSelectAllInstances:toggleSelectAllInstances,chartSizeStyle:chartSizeStyle,toggleChartSize:toggleChartSize,afterRender:afterRender,findingInEditing:findingInEditing,findingInstanceSelected:findingInstanceSelected,findingTextInputted:findingTextInputted,saveEditFinding:saveEditFinding,showEditFindingModal:showEditFindingModal,removeFinding:removeFinding,numOfColumn:numOfColumn,isValidInput:isValidInput,readOnly:ko.unwrap(params.readOnly)}};return{viewModel:{createViewModel:createViewModelFunc},template:'<div data-bind="visible: (visible() | showCustomization()),  css: (!visible() & showCustomization()) ? \'opaque\': \'\'">\r\n                            <section>\r\n                                <div style="border-bottom: 1px solid #d6dfe6;position: relative;margin-bottom:20px" data-bind="visible: !readOnly && chartName() != \'__NO_CHART_SET__\'">\r\n                                    <acs-report-title-text id="title_'+randomId()+'" params="value: title, customizationEnabled: showCustomization, placeholder: \'Report Title\', css: \'chart-title-h3\'"></acs-report-title-text>\r\n                                    <div class="title-actions" style="top: 0">\r\n                                        <div class="btn-group" role="group" aria-label="Change Chart View">\r\n                                            <button type="button" class="btn btn-default builder_tooltips" title="Show as chart" aria-label="Table" data-bind="css: renderer() == \'chart\' ? \'active\' : \'\', click: toggleTable, visible: showToggleTableButton && chartName() && chartName() != \'__NO_CHART_SET__\'">\r\n                                                <span class="fa-area-chart fa"></span>\r\n                                            </button>\r\n                                            <button type="button" class="btn btn-default builder_tooltips" title="Show as table" aria-label="Chart" data-bind="css: renderer() == \'table\' ? \'active\' : \'\', click: toggleTable, visible: showToggleTableButton && chartName() && chartName() != \'__NO_CHART_SET__\'">\r\n                                                <span class="fa-table fa"></span>\r\n                                            </button>\r\n                                        </div>\r\n                                        <div class="dropdown instance-dropdown button-group" style="text-align: right" data-bind="visible: !readOnly && chartName() != \'__NO_CHART_SET__\'">\r\n                                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="fa fa-gear pull-left"></span> Configure <span class="fa-caret-down fa pull-right"></span></button>\r\n                                            <div class="dropdown-menu dropdown-largest  pull-right">\r\n                                                <div class="row row-eq-height">\r\n                                                    <div class="col-md-4 col-sm-4 col-xs-12 no-padding-top">\r\n                                                        <h5>Instances:</h5>\r\n                                                        <ui>\r\n                                                        <li><input type="checkbox" data-bind="checked: selectedInstanceIdx().length == availableInstances.length, click: toggleSelectAllInstances"/>&nbsp;<label class="label-dark">All Instances</label></li>\r\n                                                        <!-- ko foreach: availableInstances -->\r\n                                                        <li><input type="checkbox" data-bind="checkedValue: index, checked: $parent.selectedInstanceIdx"/>&nbsp;<label class="label-dark" data-bind="text: name"></label></li>\r\n                                                        <!-- /ko -->\r\n                                                        </ui>\r\n                                                    </div>\r\n                                                    <div class="col-md-4 col-sm-4 col-xs-12 no-padding-top separator-left">\r\n                                                            <h5>Display:</h5>\r\n                                                            <div class="view-mode">\r\n                                                                <a href="javascript:void(0)" class="builder_tooltips" title="One Per Row" data-bind="css: numOfColumn() == 1 ? \'active\' : \'\', click: function() {toggleChartSize(1)}">\r\n                                                                    <input type="radio" value="1" data-bind="checked: numOfColumn().toString()"/>\r\n                                                                    <span class="view-one"></span>\r\n                                                                </a>\r\n                                                                <a href="#" class="builder_tooltips" title="Two Per Row" data-bind="css: numOfColumn() == 2 ? \'active\' : \'\', click: function() {toggleChartSize(2)}">\r\n                                                                    <input type="radio" value="2" data-bind="checked: numOfColumn().toString()"/>\r\n                                                                    <span class="view-two"></span>\r\n                                                                    <span class="view-two"></span>\r\n                                                                </a>\r\n                                                                <a href="#" class="builder_tooltips" title="Four Per Row" data-bind="css: numOfColumn() == 4 ? \'active\' : \'\', click: function() {toggleChartSize(4)}">\r\n                                                                    <input type="radio" value="4"  data-bind="checked: numOfColumn().toString()"/>\r\n                                                                    <span class="view-four"></span>\r\n                                                                    <span class="view-four"></span>\r\n                                                                    <span class="view-four"></span>\r\n                                                                    <span class="view-four"></span>\r\n                                                                </a>\r\n                                                            </div>\r\n                                                    </div>\r\n                                                    <div class="col-md-4 col-sm-4 col-xs-12 separator-left no-padding-top">\r\n                                                        <h5>Configure</h5>\r\n                                                        <ul>\r\n                                                            <li>\r\n                                                                <a href="javascript:void(0);" data-bind="css: showCustomization() ? \'\':\'disabled\', click: chartDialogVM.showConfigureChartModal"><span class="fa-sliders fa"></span> Parameters</a>\r\n                                                            </li>\r\n                                                            <li>\r\n                                                                <a href="javascript:void(0);" data-bind="css: showCustomization() ? \'\':\'disabled\', click: openChartBuilder"><span class="fa-wrench fa"></span> <span data-bind="text: type"></span> Builder</a>\r\n                                                            </li>\r\n                                                        </ul>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="row-eq-height" data-bind="visible: (showCustomization() || description()) && (chartName() != \'__NO_CHART_SET__\')">\r\n                                    <div class="pull-left">\r\n                                        <div class="fa-info-circle fa fa-3x txt-gray-lighter"></div>\r\n                                    </div>\r\n                                    <div class="col-md-11">\r\n                                        <acs-report-text id="desc_'+randomId()+'" params="icon: \'fa-info-circle\', editable: true, value: description, customizationEnabled: showCustomization, placeholder: \'[Provide description for the graph here]\'"></acs-report-text>\r\n                                    </div>\r\n                                 </div>\r\n                            </section>\r\n                            <section>\r\n                                <div class="row">\r\n                                    <!-- ko foreach: selectedChartInstances -->\r\n                                    <div data-bind="css: $parent.chartSizeStyle, visible: $parent.chartName() && $parent.chartName() != \'__NO_CHART_SET__\'">\r\n                                        <h5 data-bind="text: instance_name"></h5>\r\n                                        <acs-chart params="name: $parent.chartName,\r\n                                            instance-qualifier: $parent.instanceQualifier,\r\n                                            secondary-qualifier: $parent.secondaryQualifier,\r\n                                            renderer: $parent.renderer,\r\n                                            bind-variable: $data.bindVar,\r\n                                            event-listeners: { \'ojviewportchange\': function(event, ui) {$parent.onOjViewportChange(event, ui)} },\r\n                                            viewportMin: $parent.snapRangeFrom,\r\n                                            viewportMax: $parent.snapRangeTo,\r\n                                            zoomAndScroll: $parent.showZoomAndScroll,\r\n                                            height: $parent.height,\r\n                                            width: $parent.width,\r\n                                            outputDescription: $parent.chartTitle,\r\n                                            outputExplanation: $parent.chartDescription">\r\n                                        </acs-chart>\r\n                                    </div>\r\n                                    <!-- /ko -->\r\n                                </div>\r\n                                <div class="panel panel-default empty-content text-center no-margin-bottom" data-bind="visible: !chartName() || chartName() == \'__NO_CHART_SET__\'" style="text-align: center">\r\n                                    <div class="panel-body">\r\n                                        <a href="javascript:void(0)" title="click to select", data-bind="click: chartDialogVM.showConfigureChartModal" class="btn btn-primary no-margin">\r\n                                        <span class="fa-plus fa pull-left"></span>Select <span data-bind="text: type"></span></a>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="clearfix" style="clear: both"></div>\r\n                            </section>\r\n                            <span data-bind="template: { afterRender: afterRender }"></span>\r\n                            <section>\r\n                                <h4 class="section-title" data-bind="visible: (findings().length > 0 || showCustomization()) && chartName() != \'__NO_CHART_SET__\'">\r\n                                    <span class="fa-lightbulb-o bg-blue icon"></span>\r\n                                    Findings\r\n                                    <div class="title-actions" data-bind="visible: findings().length > 0 && showCustomization()" style="margin-top:-5px">\r\n                                        <a href="javascript:void(0);" class="btn btn-default" data-bind="click: function() {showEditFindingModal(null)}"><span class="fa-plus fa left"></span>Create</a>\r\n                                    </div>\r\n                                </h4>\r\n                                <div class="table-body findings margin-top-15" data-bind="visible: showCustomization() && findings().length == 0 && (chartName() != \'__NO_CHART_SET__\')">\r\n                                    <div class="panel panel-default text-center empty-content">\r\n                                        <div class="panel-body">\r\n                                            <a href="javascript:void(0);" class="btn btn-primary no-margin" data-bind="click: function() {showEditFindingModal(null)}"><span class="fa-plus fa left"></span>Create Findings</a>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="pretty-list" data-bind="visible: findings().length > 0, foreach: findings">\r\n                                    <div class="row">\r\n                                        <div class="col-md-11 col-sm-11 col-xs-11 no-padding-left">\r\n                                            <b><span data-bind="text: props.target_name ? props.target_name : \'All Instances\'"></span>: </b>\r\n                                            <span data-bind="html: text"></span>\r\n                                        </div>\r\n                                        <div class="actions pull-right" data-bind="visible: $parent.showCustomization">\r\n                                            <a href="javascript:void(0);" class="builder_tooltips" title="edit" data-bind="click: function() {$parent.showEditFindingModal($data)}"><span class="fa-pencil fa"></span><em class="hidden">Edit</em></a>\r\n                                            <a href="javascript:void(0);" class="builder_tooltips" title="remove" data-bind="click: function() {$parent.removeFinding($data)}"><span class="fa-remove fa"></span><em class="hidden">Remove</em></a>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </section>\r\n                       </div>\r\n                       <acs-modal-dialog\r\n                            params="title: \'Finding\',\r\n                                    titleIconClass: \'fa-gear icon blue\',\r\n                                    subtitle: \'Edit the finding for chart/table\',\r\n                                    id: \'edit-finding-modal\',\r\n                                    bodyTemplate: \'edit-finding-modal-body\',\r\n                                    actionButtonLabel: \'Save\',\r\n                                    actionButtonCallback: saveEditFinding,\r\n                                    actionButtonClass: \'fa fa-check left\',\r\n                                    actionButtonId: \'save-editing-finding-button\',\r\n                                    actionButtonDisabled: !isValidInput(),\r\n                                    viewModel: $data">\r\n                       </acs-modal-dialog>\r\n                       <acs-modal-dialog\r\n                            params="title: \'Chart/Table Configuration\',\r\n                                    titleIconClass: \'fa-gear icon blue\',\r\n                                    subtitle: \'Configure the chart or table\',\r\n                                    id: \'configure-chart-modal\',\r\n                                    bodyTemplate: \'configure-chart-modal-body\',\r\n                                    actionButtonLabel: \'Update\',\r\n                                    actionButtonCallback: chartDialogVM.saveConfiguration,\r\n                                    actionButtonClass: \'fa fa-check left\',\r\n                                    actionButtonId: \'save-configure-button\',\r\n                                    actionButtonDisabled: chartDialogVM.saveConfigureDisabled,\r\n                                    viewModel: chartDialogVM">\r\n                        </acs-modal-dialog>'}});