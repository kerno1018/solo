define(["jquery","knockout","resource-bundle","sammy"],function(e,t,a,n){function i(){var a=this;a.DELIMITERS={COLON:":"},a.menuItems=t.observableArray([]),a.menuItemKeys=t.observableArray([]),a.afterRender=function(){e.each(a.menuItemKeys(),function(n,i){a.menuItems()[i].pageFragments&&null!==a.menuItems()[i].pageFragments&&e.each(a.menuItems()[i].pageFragments,function(n,o){e(o.scope).each(function(e,n){o.viewModelNamePath=o.viewModelNamePath&&"/"!=o.viewModelNamePath[0]&&0!==o.viewModelNamePath.indexOf("modules/")?__MODULE_PREFIX__(a.menuItems()[i].module,o.viewModelNamePath):o.viewModelNamePath,o.templateNamePath=o.templateNamePath&&"/"!=o.templateNamePath[0]&&0!==o.templateNamePath.indexOf("modules/")?__MODULE_PREFIX__(a.menuItems()[i].module,o.templateNamePath):o.templateNamePath,require([o.viewModelNamePath],function(e){t.applyBindingsToNode(n,{template:{name:o.templateNamePath,data:e}})})})})})},a.generateMenu=function(t){var n=[],i=t.filter(function(e){return e.leftNavigation&&"object"==typeof e.leftNavigation});e.each(i,function(e,t){var a={};a.title=t.leftNavigation.title,a.order=t.leftNavigation.order,a.module="module"in t?t.module:"unknown",a.path=t.path,a.rootPageFragments=t.pageFragments,t.leftNavigation.pageFragments&&(a.pageFragments=t.leftNavigation.pageFragments),null===t.leftNavigation.parent?(a.icon=t.icon,a.children=[],a.id=t.id,n[t.id]=a):(a.children=null,void 0===n[t.leftNavigation.parent]&&(n[t.leftNavigation.parent]={children:[]}),n[t.leftNavigation.parent].children.push(a))}),n.filter(function(e){e.children.length>0&&e.children.sort(function(e,t){return e.order=e.order||-1,t.order=t.order||-1,e.order-t.order})}),a.menuItems(n),a.menuItemKeys(Object.keys(n))},a.toggleMenuItem=function(t,a){e(a.currentTarget).toggleClass("menu--subitens__opened"),e(a.currentTarget).find(".menu--link span.toggle").attr("class","")},a.goToPath=function(n,i){var o=n.path;if(o.indexOf(a.DELIMITERS.COLON)>-1){var r=o.split("/");r=r.filter(function(e){return e.charAt(0)===a.DELIMITERS.COLON}),n.rootPageFragments.length>0&&e.each(n.rootPageFragments,function(a,l){l.viewModelNamePath=l.viewModelNamePath&&"/"!=l.viewModelNamePath[0]&&0!==l.viewModelNamePath.indexOf("modules/")?__MODULE_PREFIX__(n.module,l.viewModelNamePath):l.viewModelNamePath,require([l.viewModelNamePath],function(a){e.each(r,function(e,n){o=o.replace(n,t.unwrap(a[n.substring(1)]))}),location.href=o,e(i.target).closest("li.menu--item").trigger("click")})})}else location.href=o,e(i.target).closest("li.menu--item").trigger("click")}}return i});