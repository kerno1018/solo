define(["jquery","cache-lib","user"],function(e,t,r){function n(){function e(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}var r=this;r.cache=e()?new t(-1,!1,new t.LocalStorageCacheStorage):new t}return n.prototype.setItem=function(t,n,o,i){var c=this;i=i?i:r.userId(),t=c._buildKeyWithUserContext(t,i),o=e.isEmptyObject(o)?c._defaultOptions:o,c.cache.setItem(t,n,o)},n.prototype.getItem=function(e,t){var n=this;return t=t?t:r.userId(),e=n._buildKeyWithUserContext(e,t),n.cache.getItem(e)},n.prototype.removeItem=function(e,t){var n=this;return t=t?t:r.userId(),n.cache.removeWhere(function(r,o){return r===n._buildKeyWithUserContext(e,t)||!e&&r.indexOf("acs_"+t)>-1})},n.prototype.clearAll=function(){var e=this;e.cache.clear()},n.prototype.getKeys=function(){var e=this,t=t?t:r.userId(),n=e.cache.keys();return n.forEach(function(e,r){e.indexOf("acs_"+t+"_")>-1&&(n[r]=e.replace("acs_"+t+"_",""))}),n},n.prototype._defaultOptions={expirationAbsolute:null,expirationSliding:360,priority:t.Priority.HIGH},n.prototype._buildKeyWithUserContext=function(e,t){return"acs_"+t+"_"+(e?e:"")},new n});